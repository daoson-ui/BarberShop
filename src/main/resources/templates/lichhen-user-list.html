<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Danh sách Lịch hẹn</title>

    <style>
        body { font-family: Arial; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        table, th, td { border: 1px solid #ddd; }
        th, td { padding: 10px; text-align: left; }
        th { background: #1976d2; color: white; }
        a.button {
            padding: 8px 12px; background: #1976d2; color: white;
            text-decoration: none; border-radius: 5px;
            margin-right: 6px;
        }
        a.button:hover { background: #0d47a1; }
        .btn-delete { background: red !important; }
    </style>
</head>
<body>

<h2>Danh sách Lịch hẹn</h2>

<a class="button" href="/user/lichhen/add">+ Tạo lịch hẹn</a>
<br><br>

<table>
    <tr>
        <th>Mã Lịch hẹn</th>
        <th>Bắt đầu</th>
        <th>Kết thúc</th>
        <th>Khách hàng</th>
        <th>Nhân viên</th>
        <th>Dịch vụ</th>
        <th>Thao tác</th>
    </tr>

    <tr th:each="lh : ${listLichHen}">
        <td th:text="${lh.maLh}"></td>

        <td th:text="${#temporals.format(lh.ngayGioBatDau, 'dd/MM/yyyy HH:mm')}"></td>
        <td th:text="${#temporals.format(lh.ngayGioKetThuc, 'dd/MM/yyyy HH:mm')}"></td>

        <td th:text="${lh.khachHang != null ? lh.khachHang.hoTen : '---'}"></td>
        <td th:text="${lh.nhanVien != null ? lh.nhanVien.hoTen : '---'}"></td>

        <td>
            <span th:if="${#lists.isEmpty(mapDichVu[lh.maLh])}">
                Không có
            </span>

            <span th:each="dv : ${mapDichVu[lh.maLh]}">
                • <b th:text="${dv.dichVu.tenDv}"></b>
            </span>
        </td>

        <td>
            <a class="button" th:href="@{'/user/lichhen/edit/' + ${lh.maLh}}">Sửa</a>

            <a class="button btn-delete"
               th:href="@{'/user/lichhen/delete/' + ${lh.maLh}}"
               onclick="return confirm('Bạn có chắc muốn xóa lịch hẹn này?')">
               Xóa
            </a>
        </td>
    </tr>
</table>

<br>
<a href="/user/home" class="button">← Quay lại Dashboard</a>

</body>
</html>
